function testWebP(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".sidebar__link");e.forEach(t=>{t.addEventListener("click",s=>{s.preventDefault(),e.forEach(e=>{e.classList.remove("_active")}),t.classList.add("_active")})});const t=document.querySelectorAll(".input-anim");if(t.length>0){const e=e=>{const t=e.target;t.nextElementSibling.classList.add("focus"),setTimeout(()=>{t.classList.add("blink")},300)},s=e=>{const t=e.target,s=t.nextElementSibling;""===t.value&&(s.classList.remove("focus"),t.classList.remove("blink"))},o=e=>{const t=e.placeholder;e.placeholder="";e.nextElementSibling.textContent=t};t.forEach(t=>{o(t);const a=t.closest(".form-main__input"),r=a.querySelector(".form-main__eye");r&&r.addEventListener("click",()=>{a.classList.toggle("show"),"password"===t.type?t.type="text":t.type="password"}),t.addEventListener("focusin",e),t.addEventListener("focusout",s)})}const s=document.querySelector(".form-main");let o,a,r;s&&(o=s.userFirstName,a=s.userLastName,r=s.userPassword);const n=document.querySelectorAll(".btn");if(n.length>0){const e=e=>{let t=!1;return 0===e.offsetX&&0===e.offsetY?t=!0:s?document.activeElement!==o&&document.activeElement!==a&&document.activeElement!==r||(t=!0):-1===e.pointerId&&(t=!0),t};n.forEach(t=>{t.addEventListener("click",s=>{let o=s.offsetX,a=s.offsetY;e(s)&&(o=s.target.offsetWidth/2,a=s.target.offsetHeight/2);const r=2*Math.max(s.target.offsetWidth,s.target.offsetHeight),n=document.createElement("span");n.style.left=o+"px",n.style.top=a+"px",setTimeout(()=>{n.style.width=r+"px",n.style.height=r+"px",n.style.opacity="0"},5),t.appendChild(n),setTimeout(()=>{n.remove()},500)})})}const c=document.querySelectorAll(".users__tab");if(c.length>0){const e=document.querySelector(".users__empty"),t=e.classList.contains("_show"),s=document.querySelector(".users__popup");s&&(setTimeout(()=>{s.classList.add("show")},0),setTimeout(()=>{s.classList.remove("show")},5e3)),c.forEach(s=>{s.addEventListener("click",()=>{s.classList.toggle("_active"),function(){const s=Flip.getState(a),r=o.filter(e=>e.classList.contains("_active")).map(e=>"."+e.textContent),n=r.length?gsap.utils.toArray(r.join(",")):r;a.forEach(e=>e.style.display=-1===n.indexOf(e)?"none":"inline-flex");Array.from(a).reduce((e,t)=>-1===n.indexOf(t)?e:e+1,0)||e.classList.contains("_show")?t||e.classList.remove("_show"):e.classList.add("_show");Flip.from(s,{duration:.6,scale:!0,ease:"power1.inOut",onEnter:e=>gsap.fromTo(e,{opacity:0,scale:0},{opacity:1,scale:1,duration:.6}),onLeave:e=>gsap.to(e,{opacity:0,scale:0,duration:.6})})}()})});const o=gsap.utils.toArray(".users__tab"),a=gsap.utils.toArray(".users__item")}const i=document.querySelector(".record__btn");if(i){const e=document.querySelector(".record__icon img"),t=document.querySelector(".record__icon img._hide"),s=document.querySelector(".record__title"),o=document.querySelector(".record"),a=document.querySelector(".progress"),r=Array.from(document.querySelectorAll(".progress__step")),n=()=>{o.classList.add("_hide"),a.classList.remove("_hide"),fetch("/split",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({className:i.dataset.id})}).then(e=>{if(!e.ok)throw new Error("Failed to start detection task");return e.json()}).then(e=>{console.log(e.message),"Ok"===e.message&&c()}).catch(e=>console.error(e))},c=()=>{r[0].classList.remove("_progress"),r[0].classList.add("_done"),r[1].classList.add("_progress"),fetch("/train",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok)throw new Error("Failed to start detection task");return e.json()}).then(e=>{"Ok"===e.message&&l()}).catch(e=>console.error(e))},l=()=>{r[1].classList.remove("_progress"),r[1].classList.add("_done"),r[2].classList.add("_progress"),fetch("/best",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i.dataset.id})}).then(e=>{if(200===e.status)return e.json();if(302!==e.status)throw new Error("Failed to start detection task");window.location.href=e.url}).then(e=>{e.redirect_url?window.location.href=e.redirect_url:console.log(e.message)}).catch(e=>console.error(e))};i.addEventListener("click",()=>{e.classList.add("_hide"),t.classList.remove("_hide"),i.textContent="Recording...",i.disabled=!0,s.textContent="Move your head a bit",fetch("/recording",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i.dataset.id})}).then(e=>{if(!e.ok)throw new Error("Failed to start detection task");return e.json()}).then(e=>{"Ok"===e.message&&n()}).catch(e=>console.error(e))})}const l=document.querySelector(".auth");if(l){document.body.style.backgroundColor="#F2709C",setTimeout(()=>{l.classList.add("_lock"),document.body.style.transition="background-color .3s cubic-bezier(0.34, 1.55, 0.64, 1)"},200);const e=()=>{l.classList.add("_open"),document.body.style.backgroundColor="#fff"},t=()=>{l.classList.add("_error")};fetch("/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:l.dataset.id})}).then(e=>{if(!e.ok)throw new Error("Failed to start detection task");return e.json()}).then(s=>{"Ok"===s.message?e():t()}).catch(e=>console.error(e))}}),testWebP((function(e){1==e?document.querySelector("body").classList.add("webp"):document.querySelector("body").classList.add("no-webp")}));const selectSingle=document.querySelectorAll("[data-state]"),selectSingle_title=document.querySelectorAll("[data-default]"),labels=document.querySelectorAll("[data-for]");if(selectSingle){const e=e=>{e.setAttribute("data-state",""),e.querySelector(".select__title").classList.remove("active")},t=e=>{selectSingle.forEach(e=>{e.setAttribute("data-state",""),e.querySelector(".select__title").classList.remove("active")}),e.setAttribute("data-state","active"),e.querySelector(".select__title").classList.add("active")},s=s=>{"active"===s.getAttribute("data-state")?e(s):t(s)};labels.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-for"),o=document.querySelector(`[data-name="${t}"]`);s(o)})}),selectSingle.forEach((t,o)=>{"honorific"===t.dataset.name&&(t.closest(".form-main__select").style.display="none");const a=selectSingle_title[o];a.querySelector("span").innerHTML=a.dataset.default,document.addEventListener("click",(function(e){const s=e.target;s.closest("[data-state]")||s.closest("[data-for]")||(t.setAttribute("data-state",""),t.querySelector(".select__title").classList.remove("active"))})),t.addEventListener("keydown",o=>{"Enter"===o.key&&s(t),"Tab"===o.key&&e(t)}),a.addEventListener("click",()=>s(t)),t.querySelector(".select__body").addEventListener("click",e=>{const s=e.target;if(s.closest("input"))if(selectSingle_title[o].querySelector("span").textContent=s.value,t.setAttribute("data-state",""),"Teacher"===s.value)t.closest(".form-main__select").nextElementSibling.style.display="block";else if("Student"===s.value){t.closest(".form-main__select").nextElementSibling.style.display="none";const e=t.closest(".form-main__select").nextElementSibling.querySelector("[data-state]"),s=e.querySelector("[data-default]");s.querySelector("span").innerHTML=s.dataset.default,e.querySelectorAll("input").forEach(e=>{e.checked=!1})}})})}